version: "2.1"
services:
  gluetun:
    image: qmcgaw/gluetun:v3.35.0
    cap_add:
      - NET_ADMIN
    ports:
      - 8888:8888/tcp # HTTP proxy
      - 8388:8388/tcp # Shadowsocks
      - 8388:8388/udp # Shadowsocks
      - 8080:8080 #qbitt
      - 6881:6881
      - 6881:6881/udp
    volumes:
       - /srv/dockerapps/gluetun:/gluetun
    environment:
      # See https://github.com/qdm12/gluetun/wiki
      - VPNSP=mullvad
      - VPN_TYPE=wireguard
      # OpenVPN:
      #- OPENVPN_USER=
      #- OPENVPN_PASSWORD=
      # Wireguard:
      - WIREGUARD_PRIVATE_KEY=IDOi/HsHfWyjE2ErRv7p5eicaf1AlL1h7xuq700vBVA=
      - WIREGUARD_ADDRESS=10.66.70.6/32
      - COUNTRY=SWITZERLAND
      # Timezone for accurate log times
      - TZ=America/Los_Angeles
    restart: unless-stopped

  qbittorrent:
   image: qbittorrentofficial/qbittorrent-nox:latest
   network_mode: "service:gluetun"
   container_name: qbittorrent-nox
   environment:
    - PUID=1000
    - PGID=1000
    - TZ=America/Los_Angeles
    - QBT_WEBUI_PORT=8080
   stop_grace_period: 30m
   tmpfs:
    - /tmp
   volumes:
    - ./config:/config
    - /media/qbittorrent/downloads:/downloads
   restart: unless-stopped

  prowlarr:
    image: lscr.io/linuxserver/prowlarr:latest
    container_name: prowlarr
    environment:
      - PUID=1000
      - PGID=1000
      - TZ=America/Los_Angeles
    volumes:
      - ./prowlarr:/config
      - /media/prowlarr/downloads:/downloads
    ports:
      - 9696:9696
    restart: unless-stopped

  flaresolverr:
    # DockerHub mirror flaresolverr/flaresolverr:latest
    image: ghcr.io/flaresolverr/flaresolverr:latest
    container_name: flaresolverr
    environment:
      - LOG_LEVEL=${LOG_LEVEL:-info}
      - LOG_HTML=${LOG_HTML:-false}
      - CAPTCHA_SOLVER=${CAPTCHA_SOLVER:-none}
      - TZ=America/Los_Angeles
    ports:
      - "${PORT:-8191}:8191"
    restart: unless-stopped

  watchtower:
    restart: always
    environment:
      WATCHTOWER_SCHEDULE: 0 30 11 * * *
      TZ: America/Los Angeles
      WATCHTOWER_CLEANUP: "true"
      WATCHTOWER_DEBUG: "true"
      WATCHTOWER_NOTIFICATIONS: slack
      WATCHTOWER_NOTIFICATION_SLACK_HOOK_URL: "https://discordapp.com/api/webhooks/https://discord.com/api/webhooks/1124147379805880340/GRSoo7mNNfsH2ld6mg3IGK3hbELfce4fGVM8HwsLcIzppFp2qzWbyW00RfE_OhcwyhXs/slack"
    image: containrrr/watchtower
    volumes:
      - /var/run/docker.sock:/var/run/docker.sock
    ports:
    - 9090:8080
